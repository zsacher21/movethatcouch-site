<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MOVE THAT COUCH! — Driver Windshield Flyer</title>

  <style>
    :root{
      --black:#111;
      --gray:#6b7280;
      --light:#f3f4f6;
      --green:#29b34a;
      --page-w: 2550px;
      --page-h: 3300px;
      --pad: 160px;
      --font: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:#ddd;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:var(--font);
      color:var(--black);
    }

    /* IMPORTANT: exporter looks for #flyer */
    .page{
      width:var(--page-w);
      height:var(--page-h);
      background:#fff;
      position:relative;
      overflow:hidden;
    }

    /* LOCK THE FOLD TO THE TRUE CENTER:
       top half (1fr) + divider (16px) + bottom half (1fr) */
    .wrap{
      position:absolute;
      inset:0;
      padding:var(--pad);
      display:grid;
      grid-template-rows: 1fr 16px 1fr;
      gap:0;
    }

    .topHalf{
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      gap:70px;
      padding-top:0;
      min-height:0;
    }

    .bottomHalf{
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      padding-top:70px;
      min-height:0;
    }

    .headline{
      display:flex;
      flex-direction:column;
      gap:18px;
    }
    .headline h1{
      margin:0;
      font-size:150px;
      line-height:0.95;
      letter-spacing:-1px;
      font-weight:900;
      text-transform:uppercase;
    }
    .headline .sub{
      font-size:46px;
      font-weight:700;
      color:var(--black);
      line-height:1.25;
    }

    /* ACTION ROW: LOGO | QR | CTA */
    .actionRow{
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:90px;
      padding:20px 0 10px;
    }

    .brand{
      display:flex;
      align-items:center;
      justify-content:flex-start;
      min-height:520px;
    }

    /* Visually "crop/zoom" logo to remove baked-in padding */
    .brand .logoFrame{
      width:520px;
      height:520px;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .brand img{
      height:520px;
      width:520px;
      object-fit:cover;
      transform: scale(1.35);   /* adjust 1.25–1.55 if needed */
      transform-origin:center;
      display:block;
    }

    .qrBlock{
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .qrBox{
      width:520px;
      height:520px;
      background:#fff;
      border-radius:26px;
      padding:18px; /* quiet zone */
      box-shadow:0 12px 30px rgba(0,0,0,.08);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .qrBox img{
      width:100%;
      height:100%;
      object-fit:contain;
      image-rendering:pixelated;
      display:block;
    }
    .qrFallback{
      position:absolute;
      inset:18px;
      border:3px dashed #d1d5db;
      border-radius:18px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      padding:24px;
      color:#9ca3af;
      font-weight:800;
      font-size:34px;
      letter-spacing:0.5px;
      text-transform:uppercase;
      pointer-events:none;
    }
    .qrFallback.hidden{ display:none; }

    .cta{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      justify-content:center;
      min-height:520px;
      gap:18px;
    }
    .cta .scanTo{
      font-size:64px;
      font-weight:900;
      text-transform:uppercase;
      line-height:1;
      margin:0;
    }
    .cta .startDriving{
      font-size:94px;
      font-weight:900;
      text-transform:uppercase;
      line-height:1;
      margin:0;
      color:var(--green);
    }
    .cta .meta{
      font-size:44px;
      font-weight:700;
      color:var(--gray);
    }

    /* Divider is now a dedicated grid row (always centered) */
    .divider{
      height:16px;
      background:#e5e7eb;
      width:calc(100% + (var(--pad) * 2));
      margin-left:calc(var(--pad) * -1);
      margin-right:calc(var(--pad) * -1);
      align-self:center;
    }

    .bottom{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:110px;
      align-items:start;
      margin-top:10px;
    }

    .sectionTitle{
      font-size:56px;
      font-weight:900;
      margin:0 0 24px 0;
    }

    .bullets{
      margin:0;
      padding-left:44px;
      display:flex;
      flex-direction:column;
      gap:16px;
      font-size:44px;
      line-height:1.35;
      font-weight:600;
    }
    .miniTitle{
      margin:42px 0 16px 0;
      font-size:50px;
      font-weight:900;
    }
    .miniBullets{
      margin:0;
      padding-left:44px;
      display:flex;
      flex-direction:column;
      gap:16px;
      font-size:44px;
      line-height:1.35;
      font-weight:600;
    }

    .whatIs p{
      margin:0 0 18px 0;
      font-size:44px;
      line-height:1.45;
      font-weight:600;
    }
    .whatIs .strong{ font-weight:900; }

    .footerNote{
      position:absolute;
      left:var(--pad);
      right:var(--pad);
      bottom:80px;
      font-size:26px;
      color:#9ca3af;
      display:flex;
      justify-content:space-between;
      gap:40px;
      pointer-events:none;
    }
  </style>
</head>

<body>
  <div class="page" id="flyer">
    <div class="wrap">

      <!-- TOP HALF -->
      <div class="topHalf">
        <div class="headline">
          <h1>GOT A TRUCK?<br/>GET PAID TO USE IT.</h1>
          <div class="sub">
            Single-item &amp; small-load deliveries<br/>
            Furniture &bull; Appliances &bull; Marketplace pickups
          </div>
        </div>

        <!-- LOGO | QR | CTA -->
        <div class="actionRow">
          <div class="brand">
            <div class="logoFrame">
              <img
                id="brandLogo" data-role="logo"
                alt="MOVE THAT COUCH! logo"
                crossorigin="anonymous"
                referrerpolicy="no-referrer"
              />
            </div>
          </div>

          <div class="qrBlock">
            <div class="qrBox">
              <img
                id="qrImage" data-role="qr"
                alt="QR code to start driving"
                crossorigin="anonymous"
                referrerpolicy="no-referrer"
              />
              <div id="qrFallback" class="qrFallback">QR WILL APPEAR HERE</div>
            </div>
          </div>

          <div class="cta">
            <div class="scanTo">SCAN TO</div>
            <div class="startDriving">START DRIVING</div>
            <div class="meta">Free to join &bull; Takes ~2 minutes</div>
          </div>
        </div>
      </div>

      <!-- CENTER FOLD DIVIDER (fixed true center) -->
      <div class="divider"></div>

      <!-- BOTTOM HALF -->
      <div class="bottomHalf">
        <div class="bottom">
          <div>
            <div class="sectionTitle">You&rsquo;re in Control.</div>
            <ul class="bullets">
              <li>Set your own quotes</li>
              <li>Accept only the jobs you want</li>
              <li>Work when it fits your schedule</li>
              <li>Customers pay a <strong>20%</strong> booking deposit in-app</li>
              <li>You&rsquo;re paid directly for the rest</li>
            </ul>

            <div class="miniTitle">Perfect If You Have:</div>
            <ul class="miniBullets">
              <li>Pickup truck</li>
              <li>Cargo van</li>
              <li>Box truck</li>
              <li>Trailer</li>
            </ul>
          </div>

          <div class="whatIs">
            <div class="sectionTitle">What Is MOVE THAT COUCH!?</div>
            <p>MOVE THAT COUCH! connects people who need a single item or small load delivered with nearby independent drivers.</p>
            <p>You quote the job.<br/>They book it.<br/>You deliver.</p>
            <p class="strong">Built for independent drivers. Scales with you.</p>
            <p>Sign up as a solo driver &mdash; or operate under a business or fleet account if you have one.</p>
            <p><span class="strong">Refer drivers or customers.</span><br/>Earn cash when jobs are completed.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="footerNote">
      <div>Independent drivers and businesses are not employees.</div>
      <div>Platform facilitates bookings only.</div>
    </div>
  </div>

  <script>
    // === FlyerExport handshake: flyerExport.js waits for window.__flyerReady Promise ===
    window.__flyerReady = (async () => {

      const logoEl = document.querySelector('#brandLogo, #logo, #brand, #flyerLogo, img[data-role="logo"]');
      const qrEl   = document.querySelector('#qrImage, #qr, #qrCode, #qrImg, img[data-role="qr"]');
      const qrFallback = document.getElementById("qrFallback");

      function setLogo(src) {
        if (!src || !logoEl) return;
        logoEl.src = src;
      }

      function setQR(dataUrl) {
        if (!dataUrl || !qrEl) return;
        qrEl.src = dataUrl;
        if (qrFallback) qrFallback.classList.add("hidden");
      }

      function loadScript(src){
        return new Promise((resolve, reject) => {
          const existing = document.querySelector(`script[data-src="${src}"]`);
          if (existing) return resolve();

          const s = document.createElement("script");
          s.src = src;
          s.async = true;
          s.dataset.src = src;
          s.onload = resolve;
          s.onerror = reject;
          document.head.appendChild(s);
        });
      }

      function waitImg(img){
        return new Promise((resolve) => {
          if (!img) return resolve();
          if (img.complete && img.naturalWidth > 0) return resolve();
          const done = () => resolve();
          img.addEventListener("load", done, { once:true });
          img.addEventListener("error", done, { once:true });
        });
      }

      // 1) Known-good default logo path in your repo
      if (logoEl && !logoEl.src) setLogo("/logo.png");

      // 2) Optional injected globals
      const g = window;
      const injectedLogo = g.MTC_FLYER_LOGO_SRC || g.FLYER_LOGO_SRC || g.__FLYER_LOGO_SRC || null;
      const injectedQr   = g.MTC_FLYER_QR_SRC || g.FLYER_QR_SRC || g.__FLYER_QR_SRC || g.MTC_FLYER_QR_PNG_DATA_URL || null;

      if (injectedLogo) setLogo(injectedLogo);
      if (injectedQr) setQR(injectedQr);

      // 3) Generate QR from ?qr=... (exporter passes this)
      const params = new URLSearchParams(window.location.search);
      const qrLink = params.get("qr") || "https://www.movethatcouch.com/";

      const needsGeneratedQR = !(qrEl && qrEl.src && qrEl.src.startsWith("data:image/"));

      if (needsGeneratedQR) {
        await loadScript("https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js");

        if (typeof window.qrcode === "function") {
          const size = 1400; // high-res -> downscaled into 520px box
          const canvas = document.createElement("canvas");
          canvas.width = size;
          canvas.height = size;

          const qr = window.qrcode(0, "M");
          qr.addData(qrLink);
          qr.make();

          const ctx = canvas.getContext("2d");
          const cells = qr.getModuleCount();
          const tile = size / cells;

          ctx.fillStyle = "#ffffff";
          ctx.fillRect(0, 0, size, size);

          ctx.fillStyle = "#000000";
          for (let r = 0; r < cells; r++) {
            for (let c = 0; c < cells; c++) {
              if (qr.isDark(r, c)) {
                ctx.fillRect(
                  Math.floor(c * tile),
                  Math.floor(r * tile),
                  Math.ceil(tile),
                  Math.ceil(tile)
                );
              }
            }
          }

          setQR(canvas.toDataURL("image/png"));
        }
      }

      // 4) Optional postMessage support
      window.addEventListener("message", (e) => {
        const data = e && e.data ? e.data : null;
        if (!data || typeof data !== "object") return;

        if (data.type === "MTC_SET_FLYER_ASSETS") {
          if (data.logoSrc) setLogo(data.logoSrc);
          if (data.qrSrc) setQR(data.qrSrc);
        }
        if (data.type === "MTC_SET_FLYER_QR" && data.qrSrc) setQR(data.qrSrc);
        if (data.type === "MTC_SET_FLYER_LOGO" && data.logoSrc) setLogo(data.logoSrc);
      });

      // 5) Wait for images to load before snapshot
      await Promise.all([waitImg(logoEl), waitImg(qrEl)]);

      window.__MTC_FLYER_READY = true;
      document.documentElement.setAttribute("data-flyer-ready", "true");
    })();
  </script>
</body>
</html>
